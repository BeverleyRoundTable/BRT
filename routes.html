<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Sleigh Routes</title>

<style>
    body {
        background: #0b0b0c;
        color: #fff;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial;
        margin: 0;
        padding: 0;
    }

    h1 {
        text-align: center;
        padding: 26px 0 10px;
        font-size: 2rem;
        letter-spacing: 0.5px;
    }

    #tonights-route,
    #all-routes {
        max-width: 950px;
        margin: 0 auto;
        padding: 0 18px;
    }

    .santa-route-card {
        background: rgba(255,255,255,0.06);
        border: 1px solid rgba(255,255,255,0.12);
        border-radius: 16px;
        padding: 22px;
        margin: 25px 0;
        box-shadow: 0 4px 18px rgba(0,0,0,0.35);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .santa-route-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 26px rgba(0,0,0,0.45);
    }

    .santa-route-card--highlight {
        border: 1px solid #ffd700;
        box-shadow: 0 0 22px rgba(255,215,0,0.25);
    }

    .santa-route-main {
        display: flex;
        flex-direction: column;
        gap: 18px;
    }

    .santa-route-text h3 {
        font-size: 1.7rem;
        margin: 0 0 8px;
        text-align: left;
    }

    .santa-route-date {
        opacity: 0.9;
        margin-bottom: 10px;
    }

    .santa-route-streets {
        opacity: 0.9;
        line-height: 1.5;
        margin-bottom: 8px;
    }

    .santa-route-actions {
        margin: 10px 0 5px;
    }

    .santa-btn {
        display: inline-block;
        background: #d31c1c;
        padding: 10px 18px;
        border-radius: 10px;
        color: #fff;
        margin-right: 10px;
        margin-bottom: 10px;
        font-weight: 600;
        text-decoration: none;
        box-shadow: 0 0 6px rgba(211, 28, 28, 0.45);
        transition: transform 0.15s ease, box-shadow 0.2s ease;
    }

    .santa-btn:hover {
        transform: scale(1.05);
        box-shadow: 0 0 12px rgba(211, 28, 28, 0.7);
    }

    .santa-btn--ghost {
        background: transparent;
        border: 2px solid #fff;
        box-shadow: none;
    }

    .santa-route-map img,
    .santa-preview {
        width: 100%;
        max-width: 430px;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.35);
        display: block;
        margin: 0 auto;
    }

    .santa-route-sponsor {
        text-align: center;
        margin-top: 18px;
        opacity: 0.95;
        font-size: 1rem;
    }

    .santa-route-sponsor img {
        width: 220px;
        max-width: 60%;
        display: block;
        margin: 10px auto;
    }

    .santa-section-title {
        text-align: center;
        font-size: 1.4rem;
        margin: 30px 0 8px;
        opacity: 0.95;
    }

    .route-divider {
        width: 100%;
        max-width: 260px;
        margin: 28px auto 10px;
        border: 0;
        border-bottom: 2px solid rgba(255,255,255,0.3);
    }

    @media (min-width: 750px) {
        .santa-route-main {
            flex-direction: row;
        }
        .santa-route-text { flex: 1; }
        .santa-route-map { flex: 1; }
    }
</style>
</head>

<body>

<h1>üéÖ Sleigh Routes</h1>

<div id="tonights-route"></div>

<hr class="route-divider">

<div id="all-routes"></div>

<script>
/* ===================================================
   API HANDLING ‚Äî CLEAN URL + RELOAD SAFE
=================================================== */

// 1Ô∏è‚É£ Read from URL
const params = new URLSearchParams(location.search);
let api = params.get("api");

// 2Ô∏è‚É£ Fallback to sessionStorage (refresh-safe)
if (!api) {
  api = sessionStorage.getItem("SANTA_API");
}

// 3Ô∏è‚É£ Still missing ‚Üí hard stop (by design)
if (!api) {
  alert("Missing ?api=YOUR_SCRIPT_URL");
} else {
  // 4Ô∏è‚É£ Store for future reloads
  sessionStorage.setItem("SANTA_API", api);

  // 5Ô∏è‚É£ Hide ?api= from the address bar (UX only)
  if (location.search.includes("api=")) {
    history.replaceState(null, "", location.pathname);
  }
}

/* ===================================================
   LOAD ROUTES.JS (unchanged)
=================================================== */
(function () {
  const s = document.createElement("script");
  s.src = "https://brt-23f.pages.dev/routes.js?v=" + Date.now();
  document.body.appendChild(s);
})();
</script>

</body>
</html>
