<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Google Drive Photo Carousel ‚Äì Setup Guide</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
  body {
    background: #111;
    color: #fff;
    font-family: Arial, sans-serif;
    line-height: 1.6;
    padding: 30px;
    max-width: 900px;
    margin: auto;
  }
  h1, h2 {
    text-align: center;
    color: #ffd700;
  }
  h2 { margin-top: 50px; }

  .step {
    background: rgba(255,255,255,0.05);
    padding: 20px 25px;
    border-radius: 12px;
    border: 1px solid rgba(255,255,255,0.15);
    margin-bottom: 35px;
    box-shadow: 0 0 14px rgba(255,215,0,0.15);
  }

  pre {
    background: #222;
    padding: 12px;
    border-radius: 8px;
    overflow-x: auto;
    border: 1px solid rgba(255,255,255,0.2);
    white-space: pre-wrap;
    font-size: 0.86rem;
  }

  .copy-btn {
    display:inline-block;
    margin-bottom:10px;
    padding:6px 12px;
    border-radius:8px;
    border:none;
    background:#e53935;
    color:#fff;
    font-size:0.8rem;
    font-weight:600;
    cursor:pointer;
  }
  .copy-btn.copied {
    background:#2e7d32;
  }
</style>
</head>
<body>

<h1>üñºÔ∏è Google Drive Photo Carousel ‚Äì Setup Guide</h1>
<p style="text-align:center;max-width:700px;margin:auto;">
Add a live-updating photo carousel to your website.
<br><br>
Just drop images into a Google Drive folder ‚Äî your site updates automatically.
</p>


<!-- STEP 1 -->
<h2>1Ô∏è‚É£ Create a Google Drive Folder for Your Photos</h2>
<div class="step">
  <ol>
    <li>Go to <a href="https://drive.google.com" target="_blank">Google Drive</a>.</li>
    <li>Click <strong>New ‚Üí Folder</strong>.</li>
    <li>Name it something like <strong>Sleigh Carousel</strong>.</li>
    <li>Open the folder.</li>
    <li>Copy the folder ID from the URL:<br><br>
      <code>https://drive.google.com/drive/folders/<b>FOLDER_ID_HERE</b></code>
    </li>
  </ol>

  <p>This ID will go into your Apps Script.</p>
</div>


<!-- STEP 2 -->
<h2>2Ô∏è‚É£ Create the Apps Script</h2>
<div class="step">
  <ol>
    <li>Go to <a href="https://script.google.com" target="_blank">Google Apps Script</a>.</li>
    <li>Create a new project.</li>
    <li>Delete any starter code.</li>
    <li>Paste this entire script:</li>
  </ol>

  <button class="copy-btn" data-target="code-script">Copy Script</button>
  <pre id="code-script">
function doGet() {
  const folderId = 'YOUR_FOLDER_ID_HERE';
  const folder = DriveApp.getFolderById(folderId);
  const files = folder.getFiles();

  let images = [];

  while (files.hasNext()) {
    let file = files.next();

    if (file.getMimeType().startsWith("image/")) {
      // Use Advanced Drive API to get a full-quality thumbnail (fast)
      const thumbnail = Drive.Files.get(file.getId(), {
        fields: "thumbnailLink"
      });

      if (thumbnail.thumbnailLink) {
        images.push(thumbnail.thumbnailLink.replace("=s220", "=s800"));
      }
    }
  }

  const template = HtmlService.createTemplateFromFile("index");
  template.images = images;
  return template.evaluate()
    .setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL);
}
  </pre>

  <p>
    Replace:  
    <code>'YOUR_FOLDER_ID_HERE'</code>  
    with your real Google Drive folder ID.
  </p>
</div>


<!-- STEP 3 -->
<h2>3Ô∏è‚É£ Enable the Advanced Drive API</h2>
<div class="step">
  <ol>
    <li>In Apps Script, click <strong>Services</strong> (puzzle-piece icon).</li>
    <li>Click <strong>+ Add a service</strong>.</li>
    <li>Select **Drive API**.</li>
    <li>Click <strong>Add</strong>.</li>
  </ol>

  <p>‚ùóThis is required to call <code>Drive.Files.get()</code>.</p>
</div>


<!-- STEP 4 -->
<h2>4Ô∏è‚É£ Create the HTML File ‚Äúindex‚Äù</h2>
<div class="step">
  <p>Your project must include a file called <strong>index.html</strong> for the template.</p>

  <ol>
    <li>In Apps Script ‚Üí click <strong>+ ‚Üí HTML</strong> & name it <code>index</code>.</li>
    <li>Paste the following simple carousel template:</li>
  </ol>

  <button class="copy-btn" data-target="carousel-html">Copy Carousel HTML</button>
  <pre id="carousel-html">
<!DOCTYPE html>
<html>
  <body style="background:#000;margin:0;padding:0;text-align:center;">
    <h2 style="color:white;padding:10px 0;">Santa Sleigh Gallery</h2>

    <? images.forEach(function(img) { ?>
      <img src="<?= img ?>" 
           style="max-width:95%;margin:10px;border-radius:12px;">
    <? }); ?>

  </body>
</html>
  </pre>
</div>


<!-- STEP 5 -->
<h2>5Ô∏è‚É£ Deploy as a Web App</h2>
<div class="step">
  <ol>
    <li>Click <strong>Deploy ‚Üí New deployment</strong>.</li>
    <li>Select <strong>Web app</strong>.</li>
    <li><strong>Execute as: Me (your account)</strong></li>
    <li><strong>Who has access: Anyone</strong></li>
    <li>Click <strong>Deploy</strong>.</li>
    <li>Copy your Web App URL.</li>
  </ol>

  <p>Example:</p>
  <pre>https://script.google.com/macros/s/AKfycbXXXXX/exec</pre>

  <p class="note">Your Drive folder‚Äôs photos will now appear automatically.</p>
</div>


<!-- STEP 6 -->
<h2>6Ô∏è‚É£ Embed on Your Website / Carrd</h2>
<div class="step">
  <p>Paste this anywhere you want the gallery to appear:</p>

  <button class="copy-btn" data-target="embed-code">Copy Embed Code</button>
  <pre id="embed-code">
&lt;iframe
  src="YOUR_WEB_APP_URL_HERE"
  loading="lazy"
  style="width:100%;height:450px;border:none;border-radius:12px;overflow:hidden;"
&gt;&lt;/iframe&gt;
  </pre>

  <p><b>Replace:</b> <code>YOUR_WEB_APP_URL_HERE</code>  
  with your Apps Script Web App URL.</p>

  <p>This works perfectly in:</p>
  <ul>
    <li>Carrd (Pro)</li>
    <li>WordPress</li>
    <li>Wix</li>
    <li>Squarespace</li>
    <li>GitHub Pages</li>
    <li>Any modern site builder</li>
  </ul>
</div>


<!-- STEP 7 -->
<h2>7Ô∏è‚É£ Add or Remove Photos ‚Äî Auto-Updates!</h2>
<div class="step">
  <p>Whenever you want to update the carousel:</p>

  <ul>
    <li>Open your Google Drive folder</li>
    <li>Drag in new photos</li>
    <li>Delete old ones</li>
  </ul>

  <p>‚úî No re-deployment  
     ‚úî No editing code  
     ‚úî Carousel updates instantly</p>
</div>


<!-- DONE -->
<h2>üéâ You're Done!</h2>
<div class="step">
  <p>Your website now has a fully automatic photo carousel powered by Google Drive & Apps Script.</p>
</div>


<script>
  // Copy button script
  document.querySelectorAll(".copy-btn").forEach(btn => {
    btn.addEventListener("click", () => {
      const id = btn.getAttribute("data-target");
      const pre = document.getElementById(id);
      if (!pre) return;
      const text = pre.textContent;
      navigator.clipboard.writeText(text).then(() => {
        btn.textContent = "Copied!";
        btn.classList.add("copied");
        setTimeout(() => {
          btn.textContent = "Copy";
          btn.classList.remove("copied");
        }, 1500);
      });
    });
  });
</script>

</body>
</html>
